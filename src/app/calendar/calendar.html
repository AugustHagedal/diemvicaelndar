<main>
  @if (countdownMessage()) {
    <div class="countdown-overlay" (click)="countdownMessage.set('')">
      <div class="countdown-message" (click)="$event.stopPropagation()">{{ countdownMessage() }}</div>
    </div>
  }

  <div class="header">
    <h1>{{ title() }}</h1>
    @if (username()) {
      <h2 class="greeting">GlÃ¦delig jul {{ username() }}! ğŸ…</h2>
    }
    <p>Tryk pÃ¥ en dag for at fÃ¥ en overraskelse!</p>
    
    <div class="button-group">
      <button class="test-button" [class.active]="testMode()" (click)="toggleTestMode()">
        {{ testMode() ? 'Test Mode: ON' : ' Test Mode: OFF' }}
      </button>
      <button class="reset-button" (click)="resetAllDays()">Reset All Days</button>
      <button class="logout-button" (click)="logout()">Log Out</button>
    </div>
  </div>

  @if (isLoading()) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p class="loading-text">IndlÃ¦ser julekalender...</p>
    </div>
  }

  @if (!isLoading()) {
    <div class="calendar-grid">
      @for (day of days(); track day.day) {
        <div 
          class="calendar-day"
          [class.opened]="day.opened"
          [class.locked]="!day.isAvailable && !day.opened"
          (click)="openDay(day)"
        >
          <div class="day-number">{{ day.day }}</div>
          @if (!day.opened && !day.isAvailable) {
            <div class="door-icon locked-icon">ğŸ”’</div>
          }
          @if (!day.opened && day.isAvailable) {
            <div class="door-icon">ğŸ</div>
          }
          @if (day.opened) {
            <div class="day-content">{{ day.unlocked_content_text }}</div>
          }
          <div class="weekday-label">{{ day.weekday }}</div>
        </div>
      }
    </div>
  }
</main>
